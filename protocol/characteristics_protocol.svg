<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1031" height="1695"><desc>%2F%2F%20participants%0Aparticipantgroup%20%23lightblue%20**Attester**%0Aparticipant%20TPM%0Aparticipant%20CPU%0Aend%0Aparticipant%20Verifier%0A%0A%0A%2F%2F%20Registration%0ATPM%3C-%3ECPU%3A%20Generate%20AES%20128%20bit%20key%20and%20IV%0ACPU%20%3C%3C-%23gray%3E%3E%20Verifier%3A%20%20%20%20%20%20AES%20key%2C%20IV%20and%20MAC%20address%0Agroup%20%23red%20registrationChr%0ACPU%20%3C-%3ETPM%3A%20createek()%0ACPU-%230000ff%3A1%3EVerifier%3A%20%3Cbackground%3A%23yellow%3EEkPub%2C%20EkCert%0Aparallel%0AVerifier%20-%3E%20Verifier%3A%20Store%20new%20Attester%20object%5Cn(MAC%20address%2C%20AES%20key%2C%20EkPub%2C%20EkCert)%0ACPU-%3ECPU%3A%20%20%20%20%20%20%20%20Store%20new%20Verifier%20object%5Cn%20%20%20%20%20%20%20(MAC%20address%2C%20AES%20key)%0Aparallel%20off%0Aend%0A%0A%2F%2F%20Attestation%0Agroup%20%23red%20authenticationChr%0ACPU%3C-CPU%3A%20Generate%20IV%20%2B%20nonce%0ACPU-%230000ff%3A1%3EVerifier%3A%20IV%2C%20%3Cbackground%3A%23yellow%3Eencrypted%20nonce%0AVerifier-%230000ff%3A1%3ECPU%3A%20decrypted%20nonce%0ACPU-%3ECPU%3A%20nonce%20comparison%0Aend%0Agroup%20%23red%20credActivationChr%0ACPU%3C-%3ETPM%3A%20tpm2_createak()%0ACPU-%230000ff%3A1%3EVerifier%3A%20%3Cbackground%3A%23yellow%3EAkName%0AVerifier%20-%3E%20Verifier%3A%20Generate%20credential%20secret%5Cntpm2_makecredential(secret%2C%20AkName%2C%20EkPub)%0AVerifier-%230000ff%3A1%3ECPU%3A%20%3Cbackground%3A%23yellow%3E%20credential_blob%0ACPU%3C-%3ETPM%3A%20tpm2_activatecredential(credential_blob)%0ACPU-%230000ff%3A1%3EVerifier%3A%20%3Cbackground%3A%23yellow%3Edecrypted%20credential%20secret%0Aend%0Agroup%20%23red%20attestationChr%0A%0AVerifier-%3EVerifier%3A%20Generate%20anti%20replay%20nonce%0AVerifier-%230000ff%3A1%3ECPU%3A%20%3Cbackground%3A%23yellow%3E%20nonce%0ACPU%3C-%3ETPM%3Atpm2_quote()%0ACPU-%230000ff%3A1%3EVerifier%3A%20%3Cbackground%3A%23yellow%3Esecret%20%2F%20quotes%20%2F%20event_log%0Aend%0Agroup%20%23red%20responseChr%0AVerifier-%3EVerifier%3A%201.%20nonce%20comparison%5Cn2.%20Quotes%20signature%20verification%5Cn3.%20Event%20log%20replay%5Cn4.%20PCR%20digest%20comparisons%5Cn5.%20Security%20policy%0AVerifier--%230000ff%3A1%3ECPU%3A%20%3Cbackground%3A%23orange%3EAttestation%20response%0Aend%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1031" height="1695"/></g><g><g><path fill="lightblue" stroke="black" paint-order="fill stroke markers" d=" M 32.458783841118645 9.556093930499998 L 421.1602664208646 9.556093930499998 L 421.1602664208646 1686.9364447909998 L 32.458783841118645 1686.9364447909998 L 32.458783841118645 9.556093930499998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="199.17619192481487" y="32.4253785505" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Attester</text></g><rect fill="rgb(255,204,204)" stroke="none" x="16.335203299999996" y="216.768147791" width="959.0001344650052" height="218.89172422000001"/><rect fill="rgb(255,204,204)" stroke="none" x="322.8457576403646" y="460.162676961" width="415.9149311650052" height="269.5308544499999"/><rect fill="rgb(255,204,204)" stroke="none" x="16.335203299999996" y="754.1963363609999" width="999.1334657638333" height="356.10743193999986"/><rect fill="rgb(255,204,204)" stroke="none" x="16.335203299999996" y="1134.806573251" width="871.1168184249661" height="248.29509015999997"/><rect fill="rgb(255,204,204)" stroke="none" x="322.8457576403646" y="1407.604468361" width="589.7395953834297" height="222.1587648799998"/></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 73.50841485 92.620602711 L 73.50841485 1686.9364447909998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 380.0189691903646 92.620602711 L 380.0189691903646 1686.9364447909998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 681.5874772553698 92.620602711 L 681.5874772553698 1686.9364447909998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 40.62638549111865 48.51555380100001 L 106.39044420888135 48.51555380100001 L 106.39044420888135 92.620602711 L 40.62638549111865 92.620602711 L 40.62638549111865 48.51555380100001 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="58.350081071618646" y="76.28539941099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">TPM</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 347.0452736098646 48.51555380100001 L 412.99266477086456 48.51555380100001 L 412.99266477086456 92.620602711 L 347.0452736098646 92.620602711 L 347.0452736098646 48.51555380100001 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="364.7689691903646" y="76.28539941099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">CPU</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 641.0221144995768 48.51555380100001 L 722.1528400111628 48.51555380100001 L 722.1528400111628 92.620602711 L 641.0221144995768 92.620602711 L 641.0221144995768 48.51555380100001 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="658.7458100800768" y="76.28539941099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Verifier</text></g></g><g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="119.66369354606121" y="139.99269228100002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate AES 128 bit key and IV</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 86.95773223366666 146.526773601 L 366.56965180669795 146.526773601" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(380.0189691903646,146.526773601) translate(-380.0189691903646,-146.526773601)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 366.4062997736979 139.72043889266666 L 380.0189691903646 146.526773601 L 366.4062997736979 153.33310830933334 Z"/><g transform="translate(73.50841485,146.526773601) translate(-73.50841485,-146.526773601)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 87.12108426666666 139.72043889266666 L 73.50841485 146.526773601 L 87.12108426666666 153.33310830933334 Z"/></g></g></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="422.3698888722813" y="185.731261521" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     AES key, IV and MAC address</text></g><g><path fill="none" stroke="gray" paint-order="fill stroke markers" d=" M 382.0608696028646 192.265342841 L 679.5455768428698 192.265342841" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(681.5874772553698,192.265342841) translate(-681.5874772553698,-192.265342841)"><path fill="none" stroke="gray" paint-order="fill stroke markers" d=" M 667.5922328723158 186.02194535537657 L 680.0571773898203 192.265342841 L 667.5922328723158 198.50874032662344" stroke-miterlimit="10" stroke-width="1.3612669416666667"/><g transform="translate(380.0189691903646,192.265342841) translate(-380.0189691903646,-192.265342841)"><path fill="none" stroke="gray" paint-order="fill stroke markers" d=" M 394.01421357341866 186.02194535537657 L 381.54926905591407 192.265342841 L 394.01421357341866 198.50874032662344" stroke-miterlimit="10" stroke-width="1.3612669416666667"/></g></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="191.62174587576826" y="260.873196701" width="70.28389228882813" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="194.07202637076824" y="275.57487967099996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">createek()</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 366.56965180669795 282.108960991 L 86.95773223366666 282.108960991" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(73.50841485,282.108960991) translate(-73.50841485,-282.108960991)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 87.12108426666666 275.30262628266667 L 73.50841485 282.108960991 L 87.12108426666666 288.91529569933334 Z"/><g transform="translate(380.0189691903646,282.108960991) translate(-380.0189691903646,-282.108960991)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 366.4062997736979 275.30262628266667 L 380.0189691903646 282.108960991 L 366.4062997736979 288.91529569933334 Z"/></g></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="480.4862778413926" y="306.611765941" width="100.63389076294922" height="21.23576429"/></g><g><rect fill="yellow" stroke="none" x="482.93655833639264" y="309.22539846899997" width="95.73332977294922" height="16.498555333"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="482.93655833639264" y="321.31344891099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">EkPub, EkCert</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 380.0189691903646 327.847530231 L 668.1381598717031 327.847530231" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(681.5874772553698,327.847530231) translate(-681.5874772553698,-327.847530231)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 667.9748078387031 321.04119552266667 L 681.5874772553698 327.847530231 L 667.9748078387031 334.65386493933335 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="700.9174678270365" y="352.350335181" width="167.86722053589844" height="21.23576429"/></g><g><rect fill="rgb(255,204,204)" stroke="none" x="700.9174678270365" y="368.685538481" width="268.7005487829687" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="703.3677483220365" y="367.05201815099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Store new Attester object</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="703.3677483220365" y="383.38722145099996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(MAC address, AES key, EkPub, EkCert)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 681.5874772553698 389.921302771 L 746.9282904553697 389.921302771 L 746.9282904553697 411.157067061 L 695.0367946390364 411.157067061" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(681.5874772553698,411.157067061) translate(-681.5874772553698,-411.157067061)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 695.2001466720365 404.3507323526667 L 681.5874772553698 411.157067061 L 695.2001466720365 417.96340176933336 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="399.34895976203126" y="352.350335181" width="192.05055488648438" height="21.23576429"/></g><g><rect fill="rgb(255,204,204)" stroke="none" x="399.34895976203126" y="368.685538481" width="194.41722358765625" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="401.7992402570313" y="367.05201815099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       Store new Verifier object</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="401.7992402570313" y="383.38722145099996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       (MAC address, AES key)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 380.0189691903646 389.921302771 L 445.3597823903646 389.921302771 L 445.3597823903646 411.157067061 L 393.46828657403125 411.157067061" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(380.0189691903646,411.157067061) translate(-380.0189691903646,-411.157067061)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 393.6316386070313 404.3507323526667 L 380.0189691903646 411.157067061 L 393.6316386070313 417.96340176933336 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="399.34895976203126" y="504.267725871" width="140.00056709351563" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="401.7992402570313" y="518.969408841" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate IV + nonce</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 380.0189691903646 525.503490161 L 445.3597823903646 525.503490161 L 445.3597823903646 546.739254451 L 393.46828657403125 546.739254451" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(380.0189691903646,546.739254451) translate(-380.0189691903646,-546.739254451)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 393.6316386070313 539.9329197426666 L 380.0189691903646 546.739254451 L 393.6316386070313 553.5455891593333 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="463.82794310933696" y="571.2420594009999" width="133.95056022706055" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="466.278223604337" y="585.9437423709999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IV, </text><g><rect fill="yellow" stroke="none" x="486.76155719198346" y="573.8556919289999" width="108.56666564941406" height="16.498555333"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="486.76155719198346" y="585.9437423709999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">encrypted nonce</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 380.0189691903646 592.4778236909999 L 668.1381598717031 592.4778236909999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(681.5874772553698,592.4778236909999) translate(-681.5874772553698,-592.4778236909999)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 667.9748078387031 585.6714889826666 L 681.5874772553698 592.4778236909999 L 667.9748078387031 599.2841583993333 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="474.0696099031602" y="616.9806286409998" width="113.46722663941406" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="476.5198903981602" y="631.6823116109998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">decrypted nonce</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 681.5874772553698 638.2163929309999 L 393.46828657403125 638.2163929309999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(380.0189691903646,638.2163929309999) translate(-380.0189691903646,-638.2163929309999)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 393.6316386070313 631.4100582226665 L 380.0189691903646 638.2163929309999 L 393.6316386070313 645.0227276393332 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="399.34895976203126" y="662.7191978809998" width="124.91723121705078" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="401.7992402570313" y="677.4208808509998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">nonce comparison</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 380.0189691903646 683.9549621709998 L 445.3597823903646 683.9549621709998 L 445.3597823903646 705.1907264609998 L 393.46828657403125 705.1907264609998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(380.0189691903646,705.1907264609998) translate(-380.0189691903646,-705.1907264609998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 393.6316386070313 698.3843917526665 L 380.0189691903646 705.1907264609998 L 393.6316386070313 711.9970611693332 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="171.2884099993034" y="798.3013852709998" width="110.95056404175781" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="173.7386904943034" y="813.0030682409998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">tpm2_createak()</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 366.56965180669795 819.5371495609999 L 86.95773223366666 819.5371495609999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(73.50841485,819.5371495609999) translate(-73.50841485,-819.5371495609999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 87.12108426666666 812.7308148526665 L 73.50841485 819.5371495609999 L 87.12108426666666 826.3434842693332 Z"/><g transform="translate(380.0189691903646,819.5371495609999) translate(-380.0189691903646,-819.5371495609999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 366.4062997736979 812.7308148526665 L 380.0189691903646 819.5371495609999 L 366.4062997736979 826.3434842693332 Z"/></g></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="500.269608758751" y="844.0399545109998" width="61.067228928232424" height="21.23576429"/></g><g><rect fill="yellow" stroke="none" x="502.71988925375103" y="846.6535870389998" width="56.16666793823242" height="16.498555333"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="502.71988925375103" y="858.7416374809998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AkName</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 380.0189691903646 865.2757188009998 L 668.1381598717031 865.2757188009998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(681.5874772553698,865.2757188009998) translate(-681.5874772553698,-865.2757188009998)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 667.9748078387031 858.4693840926665 L 681.5874772553698 865.2757188009998 L 667.9748078387031 872.0820535093332 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="700.9174678270365" y="889.7785237509997" width="176.75056709351563" height="21.23576429"/></g><g><rect fill="rgb(255,204,204)" stroke="none" x="700.9174678270365" y="906.1137270509997" width="308.83388008179685" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="703.3677483220365" y="904.4802067209997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate credential secret</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="703.3677483220365" y="920.8154100209997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">tpm2_makecredential(secret, AkName, EkPub)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 681.5874772553698 927.3494913409997 L 746.9282904553697 927.3494913409997 L 746.9282904553697 948.5852556309998 L 695.0367946390364 948.5852556309998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(681.5874772553698,948.5852556309998) translate(-681.5874772553698,-948.5852556309998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 695.2001466720365 941.7789209226664 L 681.5874772553698 948.5852556309998 L 695.2001466720365 955.3915903393331 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="476.72794272786723" y="973.0880605809997" width="108.15056099" height="21.23576429"/></g><g><rect fill="yellow" stroke="none" x="479.17822322286725" y="975.7016931089997" width="103.25" height="16.498555333"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="479.17822322286725" y="987.7897435509997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> credential_blob</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 681.5874772553698 994.3238248709997 L 393.46828657403125 994.3238248709997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(380.0189691903646,994.3238248709997) translate(-380.0189691903646,-994.3238248709997)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 393.6316386070313 987.5174901626664 L 380.0189691903646 994.3238248709997 L 393.6316386070313 1001.130159579333 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="92.83840542166668" y="1018.8266298209998" width="267.8505731970312" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="95.28868591666668" y="1033.5283127909997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">tpm2_activatecredential(credential_blob)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 366.56965180669795 1040.0623941109998 L 86.95773223366666 1040.0623941109998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(73.50841485,1040.0623941109998) translate(-73.50841485,-1040.0623941109998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 87.12108426666666 1033.2560594026666 L 73.50841485 1040.0623941109998 L 87.12108426666666 1046.868728819333 Z"/><g transform="translate(380.0189691903646,1040.0623941109998) translate(-380.0189691903646,-1040.0623941109998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 366.4062997736979 1033.2560594026666 L 380.0189691903646 1040.0623941109998 L 366.4062997736979 1046.868728819333 Z"/></g></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="440.5529396761094" y="1064.565199061" width="180.50056709351563" height="21.23576429"/></g><g><rect fill="yellow" stroke="none" x="443.00322017110943" y="1067.1788315889999" width="175.60000610351562" height="16.498555333"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="443.00322017110943" y="1079.266882031" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">decrypted credential secret</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 380.0189691903646 1085.8009633509998 L 668.1381598717031 1085.8009633509998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(681.5874772553698,1085.8009633509998) translate(-681.5874772553698,-1085.8009633509998)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 667.9748078387031 1078.9946286426666 L 681.5874772553698 1085.8009633509998 L 667.9748078387031 1092.607298059333 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="700.9174678270365" y="1178.9116221609997" width="180.8172327429297" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="703.3677483220365" y="1193.6133051309998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate anti replay nonce</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 681.5874772553698 1200.1473864509999 L 746.9282904553697 1200.1473864509999 L 746.9282904553697 1221.3831507409998 L 695.0367946390364 1221.3831507409998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(681.5874772553698,1221.3831507409998) translate(-681.5874772553698,-1221.3831507409998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 695.2001466720365 1214.5768160326666 L 681.5874772553698 1221.3831507409998 L 695.2001466720365 1228.189485449333 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="506.3029434908067" y="1245.885955691" width="49.000559464121096" height="21.23576429"/></g><g><rect fill="yellow" stroke="none" x="508.7532239858067" y="1248.4995882189999" width="44.099998474121094" height="16.498555333"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="508.7532239858067" y="1260.587638661" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> nonce</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 681.5874772553698 1267.1217199809998 L 393.46828657403125 1267.1217199809998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(380.0189691903646,1267.1217199809998) translate(-380.0189691903646,-1267.1217199809998)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 393.6316386070313 1260.3153852726666 L 380.0189691903646 1267.1217199809998 L 393.6316386070313 1273.928054689333 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="180.88007717459638" y="1291.624524931" width="91.76722969117188" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="183.33035766959637" y="1306.326207901" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">tpm2_quote()</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 366.56965180669795 1312.860289221 L 86.95773223366666 1312.860289221" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(73.50841485,1312.860289221) translate(-73.50841485,-1312.860289221)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 87.12108426666666 1306.0539545126667 L 73.50841485 1312.860289221 L 87.12108426666666 1319.6666239293331 Z"/><g transform="translate(380.0189691903646,1312.860289221) translate(-380.0189691903646,-1312.860289221)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 366.4062997736979 1306.0539545126667 L 380.0189691903646 1312.860289221 L 366.4062997736979 1319.6666239293331 Z"/></g></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="442.9446099031602" y="1337.363094171" width="175.71722663941406" height="21.23576429"/></g><g><rect fill="yellow" stroke="none" x="445.3948903981602" y="1339.976726699" width="170.81666564941406" height="16.498555333"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="445.3948903981602" y="1352.0647771410001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">secret / quotes / event_log</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 380.0189691903646 1358.598858461 L 668.1381598717031 1358.598858461" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(681.5874772553698,1358.598858461) translate(-681.5874772553698,-1358.598858461)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 667.9748078387031 1351.7925237526667 L 681.5874772553698 1358.598858461 L 667.9748078387031 1365.4051931693332 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="700.9174678270365" y="1451.7095172709999" width="141.23388923707031" height="21.23576429"/></g><g><rect fill="rgb(255,204,204)" stroke="none" x="700.9174678270365" y="1468.044720571" width="205.95056404175781" height="21.23576429"/></g><g><rect fill="rgb(255,204,204)" stroke="none" x="700.9174678270365" y="1484.379923871" width="125.10055793824219" height="21.23576429"/></g><g><rect fill="rgb(255,204,204)" stroke="none" x="700.9174678270365" y="1500.7151271710002" width="182.23388923707031" height="21.23576429"/></g><g><rect fill="rgb(255,204,204)" stroke="none" x="700.9174678270365" y="1517.0503304710003" width="115.86722816529297" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="703.3677483220365" y="1466.411200241" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. nonce comparison</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="703.3677483220365" y="1482.746403541" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Quotes signature verification</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="703.3677483220365" y="1499.0816068410002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Event log replay</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="703.3677483220365" y="1515.4168101410003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. PCR digest comparisons</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="703.3677483220365" y="1531.7520134410004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Security policy</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 681.5874772553698 1538.286094761 L 746.9282904553697 1538.286094761 L 746.9282904553697 1559.5218590509999 L 695.0367946390364 1559.5218590509999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(681.5874772553698,1559.5218590509999) translate(-681.5874772553698,-1559.5218590509999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 695.2001466720365 1552.7155243426666 L 681.5874772553698 1559.5218590509999 L 695.2001466720365 1566.328193759333 Z"/></g></g><g><g><rect fill="rgb(255,204,204)" stroke="none" x="461.869612954918" y="1584.024664001" width="137.86722053589844" height="21.23576429"/></g><g><rect fill="orange" stroke="none" x="464.319893449918" y="1586.638296529" width="132.96665954589844" height="16.498555333"/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="464.319893449918" y="1598.726346971" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Attestation response</text></g><g><path fill="none" stroke="#0000ff" paint-order="fill stroke markers" d=" M 681.5874772553698 1605.260428291 L 393.46828657403125 1605.260428291" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(380.0189691903646,1605.260428291) translate(-380.0189691903646,-1605.260428291)"><path fill="#0000ff" stroke="none" paint-order="stroke fill markers" d=" M 393.6316386070313 1598.4540935826667 L 380.0189691903646 1605.260428291 L 393.6316386070313 1612.0667629993332 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 16.335203299999996 216.768147791 L 975.3353377650052 216.768147791 L 975.3353377650052 435.659872011 L 16.335203299999996 435.659872011 L 16.335203299999996 216.768147791 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><path fill="red" stroke="black" paint-order="fill stroke markers" d=" M 16.335203299999996 216.768147791 L 16.335203299999996 236.370391751 L 133.78894272470703 236.370391751 L 143.59006470470703 226.569269771 L 143.59006470470703 216.768147791 L 16.335203299999996 216.768147791" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="32.67040659999999" y="229.836310431" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">registrationChr</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 322.8457576403646 460.162676961 L 738.7606888053698 460.162676961 L 738.7606888053698 729.6935314109999 L 322.8457576403646 729.6935314109999 L 322.8457576403646 460.162676961 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><path fill="red" stroke="black" paint-order="fill stroke markers" d=" M 322.8457576403646 460.162676961 L 322.8457576403646 479.764920921 L 455.8328298897786 479.764920921 L 465.6339518697786 469.963798941 L 465.6339518697786 460.162676961 L 322.8457576403646 460.162676961" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="339.18096094036457" y="473.230839601" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">authenticationChr</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 16.335203299999996 754.1963363609999 L 1015.4686690638333 754.1963363609999 L 1015.4686690638333 1110.3037683009998 L 16.335203299999996 1110.3037683009998 L 16.335203299999996 754.1963363609999 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><path fill="red" stroke="black" paint-order="fill stroke markers" d=" M 16.335203299999996 754.1963363609999 L 16.335203299999996 773.7985803209999 L 150.2556099 773.7985803209999 L 160.05673188 763.9974583409999 L 160.05673188 754.1963363609999 L 16.335203299999996 754.1963363609999" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="32.67040659999999" y="767.2644990009999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">credActivationChr</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 16.335203299999996 1134.806573251 L 887.4520217249661 1134.806573251 L 887.4520217249661 1383.101663411 L 16.335203299999996 1383.101663411 L 16.335203299999996 1134.806573251 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><path fill="red" stroke="black" paint-order="fill stroke markers" d=" M 16.335203299999996 1134.806573251 L 16.335203299999996 1154.4088172109998 L 128.63894119882812 1154.4088172109998 L 138.44006317882813 1144.607695231 L 138.44006317882813 1134.806573251 L 16.335203299999996 1134.806573251" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="32.67040659999999" y="1147.8747358909998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">attestationChr</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 322.8457576403646 1407.604468361 L 912.5853530237943 1407.604468361 L 912.5853530237943 1629.7632332409999 L 322.8457576403646 1629.7632332409999 L 322.8457576403646 1407.604468361 Z" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><path fill="red" stroke="black" paint-order="fill stroke markers" d=" M 322.8457576403646 1407.604468361 L 322.8457576403646 1427.206712321 L 427.96616118860675 1427.206712321 L 437.76728316860675 1417.405590341 L 437.76728316860675 1407.604468361 L 322.8457576403646 1407.604468361" stroke-miterlimit="10" stroke-width="2.3336004714285714" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="339.18096094036457" y="1420.672631001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">responseChr</text></g></g><g/><g/><g/></g></g></g></g></g></g></g></g></g></svg>